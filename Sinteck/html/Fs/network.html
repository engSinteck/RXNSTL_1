<!DOCTYPE html>
<html lang="en">
<head>
<title>STL RX Strider</title>
<link rel="shortcut icon" href="STM32H7xx_files/favicon.ico" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body onload="getData()"> 
    <div id="header">
          <h1>Network</h1>
    </div>
    
    <div id="img">
        <img src="STM32H7xx_files/logo.jpg" alt="" align="right" width=210 height=38>
    </div>
    
    <style>
        legend {
            padding-left:10px;
            padding-right:10px;
        }

        fieldset {
            position:relative;
            line-height:24px;
        }

        input {
            position:absolute;
            left:130px;
        }
        
        select {
            position:absolute;
            left:130px;
        }
    </style>
    
    <script>
        function validate(evt) {
            var theEvent = evt || window.event;

            // Handle paste
            if (theEvent.type === 'paste') {
                key = event.clipboardData.getData('text/plain');
            } else {
                // Handle key press
                var key = theEvent.keyCode || theEvent.which;
                key = String.fromCharCode(key);
            }
            var regex = /[0-9]|\./;
            if( !regex.test(key) ) {
                theEvent.returnValue = false;
                if(theEvent.preventDefault) theEvent.preventDefault();
            }
        }
        
        function checkLength(elem) {
            // checking if input value is more than Model
            if (elem.length > 5 ) {
                //alert( parseInt(document.getElementById("max").innerHTML) )
                elem.value = ''; // emptying the input box
            }
        }
        
        function getNetwork() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("ip1").innerHTML = this.responseText.substring(this.responseText.indexOf("IP:")+3,this.responseText.indexOf("MASK:")-1);
                    document.getElementById("mask1").innerHTML = this.responseText.substring(this.responseText.indexOf("MASK:")+5,this.responseText.indexOf("GW:")-1);
                    document.getElementById("gw1").innerHTML = this.responseText.substring(this.responseText.indexOf("GW:")+3,this.responseText.indexOf("DNS:")-1);
                    document.getElementById("dns1").innerHTML = this.responseText.substring(this.responseText.indexOf("DNS:")+4,this.responseText.indexOf("PORT:")-1);
                    document.getElementById("port1").innerHTML = this.responseText.substring(this.responseText.indexOf("PORT:")+5,this.responseText.indexOf("BROKER:")-1);
                    document.getElementById("broker").innerHTML = this.responseText.substring(this.responseText.indexOf("BROKER:")+7,this.responseText.indexOf("SNMP:")-1);
                    document.getElementById("snmp1").innerHTML = this.responseText.substring(this.responseText.indexOf("SNMP:")+5,this.responseText.indexOf("FIM:")-1);
                    
                    if(document.getElementById("snmp1").innerHTML == '1')
                        document.getElementById("snmp").checked = true;
                    else
                        document.getElementById("snmp").checked = false;
                    
                    document.getElementById("brokerAddr").value = document.getElementById("broker").innerHTML;
                    document.getElementById("ip").value = document.getElementById("ip1").innerHTML.replace(/\s/g, '');
                    document.getElementById("mask").value = document.getElementById("mask1").innerHTML.replace(/\s/g, '');
                    document.getElementById("gw").value = document.getElementById("gw1").innerHTML.replace(/\s/g, '');
                    document.getElementById("dns").value = document.getElementById("dns1").innerHTML.replace(/\s/g, '');
                    document.getElementById("port").value = document.getElementById("port1").innerHTML.replace(/\s/g, '');
                }
            };
            xhttp.open("GET", "readNetwork", true);
            xhttp.send();
        }
        
        function SendSnmp() {
            var resp = "";
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("RFState").innerHTML =
                    this.responseText;
                }
            };
            var resp1 = "setSNMP=";
            var resp2 = "";
            if(document.getElementById("snmp").checked == true)
                resp2 = "1"
            else 
                resp2 = "0"
                
            var resp = resp1.concat("", resp2, ";FIM");
            if (confirm("Confirm !")) {
                xhttp.open("GET", resp, true);
                xhttp.send();
                if(document.getElementById("snmp1").innerHTML != resp2 ) {
                    alert("A reboot is required for the settings to take effect.");
                }
            }
            else {
            }
        }
        
        function sendData() {
            var resp = "";
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("RFState").innerHTML =
                    this.responseText;
                }
            };
            var resp1 = "setNetwork=";
            var ip1 = document.getElementById("ip").value.substring(0, document.getElementById("ip").value.indexOf("."));
            var str1 = document.getElementById("ip").value.substring(document.getElementById("ip").value.indexOf(".")+1, document.getElementById("ip").value.length);
            var ip2 = str1.substring(0, str1.indexOf("."));
            var str2 = str1.substring(str1.indexOf(".")+1, str1.length);
            var ip3 = str2.substring(0, str2.indexOf("."));
            var str3 = str2.substring(str2.indexOf(".")+1, str2.length);
            var ip4 = str3.substring(0, str3.length);
            var ip = "IP1:" + ip1 + ";IP2:" + ip2 + ";IP3:" + ip3 + ";IP4:" + ip4 + ";";
            //
            ip1 = document.getElementById("mask").value.substring(0, document.getElementById("mask").value.indexOf("."));
            str1 = document.getElementById("mask").value.substring(document.getElementById("mask").value.indexOf(".")+1, document.getElementById("mask").value.length);
            ip2 = str1.substring(0, str1.indexOf("."));
            str2 = str1.substring(str1.indexOf(".")+1, str1.length);
            ip3 = str2.substring(0, str2.indexOf("."));
            str3 = str2.substring(str2.indexOf(".")+1, str2.length);
            ip4 = str3.substring(0, str3.length);
            var mask = "MASK1:" + ip1 + ";MASK2:" + ip2 + ";MASK3:" + ip3 + ";MASK4:" + ip4 + ";";
            //
            ip1 = document.getElementById("gw").value.substring(0, document.getElementById("gw").value.indexOf("."));
            str1 = document.getElementById("gw").value.substring(document.getElementById("gw").value.indexOf(".")+1, document.getElementById("gw").value.length);
            ip2 = str1.substring(0, str1.indexOf("."));
            str2 = str1.substring(str1.indexOf(".")+1, str1.length);
            ip3 = str2.substring(0, str2.indexOf("."));
            str3 = str2.substring(str2.indexOf(".")+1, str2.length);
            ip4 = str3.substring(0, str3.length);
            var gw = "GW1:" + ip1 + ";GW2:" + ip2 + ";GW3:" + ip3 + ";GW4:" + ip4 + ";";
            //
            ip1 = document.getElementById("dns").value.substring(0, document.getElementById("dns").value.indexOf("."));
            str1 = document.getElementById("dns").value.substring(document.getElementById("dns").value.indexOf(".")+1, document.getElementById("dns").value.length);
            ip2 = str1.substring(0, str1.indexOf("."));
            str2 = str1.substring(str1.indexOf(".")+1, str1.length);
            ip3 = str2.substring(0, str2.indexOf("."));
            str3 = str2.substring(str2.indexOf(".")+1, str2.length);
            ip4 = str3.substring(0, str3.length);
            var dns = "DNS1:" + ip1 + ";DNS2:" + ip2 + ";DNS3:" + ip3 + ";DNS4:" + ip4 + ";";
            
            var port = "PORT:" + document.getElementById("port").value + ";";
            
            var resp = resp1.concat("", ip, mask, gw, dns, port, "FIM");
            //alert(resp)
            if (confirm("Confirm !")) {
                xhttp.open("GET", resp, true);
                xhttp.send();
                if(document.getElementById("port1").innerHTML != document.getElementById("port").value ) {
                    alert("A reboot is required for the settings to take effect.");
                }
            }
            else {
            
            }
        }
        
        function sendToken() {
            var resp = "";
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("RFState").innerHTML =
                    this.responseText;
                }
            };
                // Token
                var resp = "GetToken=";
                //alert(resp)
                if (confirm("Confirm !")) {
                    xhttp.open("GET", resp, true);
                    xhttp.send();
                }
                else {
            
                }
            getNetwork();    
        }
        
        function sendSaveToken() {
            var resp = "";
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("RFState").innerHTML =
                    this.responseText;
                }
            };
                // Token
                var resp = "GetSaveToken=";
                //alert(resp)
                if (confirm("Confirm !")) {
                    xhttp.open("GET", resp, true);
                    xhttp.send();
                }
                else {
            
                }
        }
        
        function sendBroker() {
            var resp = "";
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("RFState").innerHTML =
                    this.responseText;
                }
            };
            // Token
            var resp1 = "GetSaveBroker=";
            var resp = resp1.concat("" , "BROKER:", document.getElementById("brokerAddr").value, ";FIM");
            //alert(resp)
            if (confirm("Confirm !")) {
                xhttp.open("GET", resp, true);
                xhttp.send();
                if(document.getElementById("broker").innerHTML != document.getElementById("brokerAddr").value ) {
                    alert("A reboot is required for the settings to take effect.");
                }
            }
            else {
            }
        }
        
        function getLogin() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("Login").innerHTML = this.responseText.substring(this.responseText.indexOf("User:")+5,this.responseText.indexOf("Config:")-1);
                document.getElementById("lock").innerHTML = this.responseText.substring(this.responseText.indexOf("Config:")+7,this.responseText.indexOf("FIM:")-1);
                if(document.getElementById("lock").innerHTML == '0') {
                    document.getElementById("teste1").className = "fa fa-unlock";
                    document.getElementById("lock2").className = "fa fa-unlock";
                    document.getElementById("lock2").style = "font-size:24px";
                }
                else {
                    document.getElementById("teste1").className = "fa fa-lock";
                    document.getElementById("lock2").className = "fa fa-lock";
                    document.getElementById("lock2").style = "font-size:24px";
                }
                
                getNetwork();
            }
        };
            xhttp.open("GET", "readLogin", true);
            xhttp.send();
        }
        
        function getData() {
            getLogin();
        }
    </script>
    
    <div id="nav">        
      <ul>
        <li><a class="group">Login: <span id="Login">user</span> <span id="lock2"></span></a></li>
		<li><a id="home" href="index.html">Dashboard</a></li>
		
        <li><a class="group">SETUP</a></li>        
        <li><a id="confaudio" href="audio.html">Audio</a></li>
        <li><a id="conftime" href="time.html">Time</a></li>
        <li><a id="confrds" href="rds.html">RDS</a></li>
        <li><a id="conffreq" href="freq.html">Frequency</a></li>
        <li><a id="confadvset" href="advset.html">Advanced Setups</a></li>
        <li><a id="confnetwork" href="network.html">Connectivity Options</a></li>
        <li><a id="confpass" href="password.html">Password</a></li>
        <li><a id="profile" href="profile.html">Station Profile</a></li>
        <li><a class="group">TOOLS</a></li>
        <li><a id="confhold" href="confighold.html">Config Hold/Factory Settings</a></li>
        <li><a id="FAIL" href="Fail.html">Fail List</a></li>
      </ul>                
    </div>
	
    <div id="section">		
            <fieldset>
                <label for="ip">IP Address:</label>
                <input type="text" id="ip" name="ip" minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
            </fieldset>
            <br>
            <fieldset>
                <label for="mask">Subnet Mask:</label>
                <input type="text" id="mask" name="mask" minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
            </fieldset>
            <br>
            <fieldset>
                <label for="gw">Default Gateway:</label>
                <input type="text" id="gw" name="gw" minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
            </fieldset>
            <br>
            <fieldset>
                <label for="dns">DNS Server:</label>
                <input type="text" id="dns" name="dns" minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$">
            </fieldset>
            <br>
            <fieldset>
                <label for="port">Port Number:</label>
                <input type='text' id="port" name="port" onkeypress='validate(event)' oninput="checkLength(this)" maxlength="5" size="5" />
            </fieldset>
            <br><br>
            <button type="button" class="myButton" onclick="sendData()">Submit</button>
            <br><br>
            <p style="background-color:LightGray;"></p>
            <br>
            <fieldset>
                <label for="snmp">Enable SNMP:</label>
                <input type="checkbox" id="snmp" name="snmp">
                <br>
                <button type="button" class="myButton" onclick="SendSnmp()">Submit </button>
            </fieldset>
            <br>
            <p style="background-color:LightGray;"></p>
            <br>
            <fieldset>
                <label for="ip">Telemetry Addr:</label>
                <input type="text" id="brokerAddr" name="brokerAddr" maxlength="64" size="64"><br>
            </fieldset>
            <br>
            <button type="button" class="myButton" onclick="sendBroker()">Submit</button>
            <br><br>
            <h5 hidden>IP: <span id="ip1">0</span></h5>
            <h5 hidden>MASK: <span id="mask1">0</span></h5>
            <h5 hidden>GW: <span id="gw1">0</span></h5>
            <h5 hidden>DNS: <span id="dns1">0</span></h5>
            <h5 hidden>PORT: <span id="port1">0</span></h5>
            <h5 hidden>BROKER: <span id="broker">0</span></h5>
            <h5 hidden>SNMP: <span id="snmp1">0</span></h5>
            <h5 hidden>Lock: <span id="lock">0</span></h5>
            <h5 hidden>Teste1: <span id="teste1"></span></h5>
			<br><br><br><br><br><br><br><br><br><br><br>
    </div>
		
    <div id="footer">
      <h5>Sinteck Next 2025 (&copy;) - <a href="http://www.sinteck.com.br" style="color:#FFFFFF;">www.sinteck.com.br</a><br></h5>
    </div>
		
</body>
</html>
